<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-en="My Dashboard | My Smart ekimina" data-rw="Ikibaho Cyanje | My Smart ekimina" data-fr="Mon Tableau de Bord | My Smart ekimina">My Dashboard | My Smart ekimina</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* Base Styles & Variables */
        :root {
            --primary: #2E5BFF;
            --primary-dark: #1A3DB0;
            --secondary: #00D4AA;
            --success: #00C851;
            --warning: #ffbb33;
            --danger: #ff4444;
            --dark: #2E384D;
            --light: #F8F9FC;
            --gray: #B0BAC9;
            --gray-light: #EDF0F7;
            --gradient: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            --shadow: 0 10px 30px rgba(46, 91, 255, 0.1);
            --border-radius: 12px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
        }

        body {
            color: var(--dark);
            background-color: var(--light);
            line-height: 1.6;
            min-height: 100vh;
        }

        .container {
            width: 100%;
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
        }

        a {
            text-decoration: none;
            color: inherit;
        }

        .btn {
            display: inline-block;
            padding: 12px 24px;
            border-radius: 8px;
            font-weight: 600;
            font-size: 0.95rem;
            cursor: pointer;
            transition: all 0.3s ease;
            border: none;
        }

        .btn-primary {
            background: var(--gradient);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow);
        }

        .btn-secondary {
            background-color: white;
            color: var(--primary);
            border: 2px solid var(--primary);
        }

        .btn-secondary:hover {
            background-color: var(--primary);
            color: white;
        }

        .btn-success {
            background-color: var(--success);
            color: white;
        }

        .btn-warning {
            background-color: var(--warning);
            color: white;
        }

        .btn-danger {
            background-color: var(--danger);
            color: white;
        }

        .btn-sm {
            padding: 8px 16px;
            font-size: 0.85rem;
        }

        .btn-icon {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        /* Header & Navigation */
        header {
            background-color: white;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.05);
            padding: 15px 0;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .navbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo-container {
            display: flex;
            align-items: center;
        }

        .logo-icon {
            width: 45px;
            height: 45px;
            background: var(--gradient);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 12px;
            position: relative;
            overflow: hidden;
        }

        .logo-icon:before {
            content: "";
            position: absolute;
            width: 60%;
            height: 60%;
            background-color: white;
            border-radius: 50%;
        }

        .logo-icon:after {
            content: "";
            position: absolute;
            width: 30%;
            height: 30%;
            background: var(--gradient);
            border-radius: 50%;
            bottom: 5px;
            right: 5px;
        }

        .logo-text {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary);
        }

        .logo-text span {
            color: var(--secondary);
        }

        .nav-right {
            display: flex;
            align-items: center;
            gap: 25px;
        }

        /* Language Switcher */
        .language-switcher {
            display: flex;
            gap: 5px;
        }

        .language-btn {
            padding: 8px 15px;
            border: 2px solid var(--gray-light);
            background: white;
            border-radius: 6px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            color: var(--dark);
            min-width: 45px;
            text-align: center;
        }

        .language-btn:hover {
            border-color: var(--primary);
            color: var(--primary);
        }

        .language-btn.active {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        /* User Profile */
        .user-profile {
            display: flex;
            align-items: center;
            gap: 12px;
            cursor: pointer;
            position: relative;
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--gradient);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 1.1rem;
        }

        .user-info {
            display: flex;
            flex-direction: column;
        }

        .user-name {
            font-weight: 600;
            font-size: 0.95rem;
        }

        .user-role {
            font-size: 0.8rem;
            color: var(--gray);
        }

        /* Dashboard Layout */
        .dashboard-container {
            display: flex;
            min-height: calc(100vh - 80px);
        }

        /* Sidebar */
        .sidebar {
            width: 250px;
            background: white;
            padding: 25px 0;
            box-shadow: 5px 0 20px rgba(0, 0, 0, 0.05);
            position: sticky;
            top: 80px;
            height: calc(100vh - 80px);
            overflow-y: auto;
        }

        .sidebar-header {
            padding: 0 25px 25px;
            border-bottom: 1px solid var(--gray-light);
            margin-bottom: 20px;
        }

        .sidebar-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--primary);
            margin-bottom: 5px;
        }

        .sidebar-subtitle {
            font-size: 0.85rem;
            color: var(--gray);
        }

        .sidebar-menu {
            list-style: none;
        }

        .menu-item {
            padding: 15px 25px;
            display: flex;
            align-items: center;
            gap: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            border-left: 4px solid transparent;
        }

        .menu-item:hover {
            background: var(--light);
            color: var(--primary);
        }

        .menu-item.active {
            background: rgba(46, 91, 255, 0.05);
            color: var(--primary);
            border-left-color: var(--primary);
            font-weight: 600;
        }

        .menu-icon {
            width: 20px;
            color: var(--gray);
            text-align: center;
        }

        .menu-item.active .menu-icon,
        .menu-item:hover .menu-icon {
            color: var(--primary);
        }

        .menu-text {
            flex: 1;
            font-size: 0.95rem;
        }

        .menu-badge {
            background: var(--primary);
            color: white;
            font-size: 0.7rem;
            padding: 2px 8px;
            border-radius: 20px;
            font-weight: 600;
        }

        /* Main Content */
        .main-content {
            flex: 1;
            padding: 30px;
        }

        /* Welcome Banner */
        .welcome-banner {
            background: var(--gradient);
            border-radius: var(--border-radius);
            padding: 30px;
            color: white;
            margin-bottom: 30px;
            position: relative;
            overflow: hidden;
        }

        .welcome-banner:before {
            content: "";
            position: absolute;
            top: -50px;
            right: -50px;
            width: 200px;
            height: 200px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
        }

        .welcome-content {
            position: relative;
            z-index: 2;
            max-width: 600px;
        }

        .welcome-content h1 {
            font-size: 1.8rem;
            margin-bottom: 10px;
        }

        .welcome-content p {
            opacity: 0.9;
            margin-bottom: 20px;
        }

        /* Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: white;
            border-radius: var(--border-radius);
            padding: 25px;
            box-shadow: var(--shadow);
            display: flex;
            align-items: center;
            gap: 20px;
            transition: transform 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-5px);
        }

        .stat-icon {
            width: 60px;
            height: 60px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: white;
        }

        .stat-info {
            flex: 1;
        }

        .stat-label {
            font-size: 0.9rem;
            color: var(--gray);
            margin-bottom: 5px;
        }

        .stat-value {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--dark);
            margin-bottom: 5px;
        }

        .stat-change {
            font-size: 0.85rem;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .stat-change.positive {
            color: var(--success);
        }

        .stat-change.negative {
            color: var(--danger);
        }

        /* Quick Actions */
        .quick-actions {
            background: white;
            border-radius: var(--border-radius);
            padding: 25px;
            box-shadow: var(--shadow);
            margin-bottom: 30px;
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
        }

        .section-title {
            font-size: 1.3rem;
            font-weight: 600;
            color: var(--dark);
        }

        .actions-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
        }

        .action-card {
            border: 2px solid var(--gray-light);
            border-radius: 10px;
            padding: 25px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .action-card:hover {
            border-color: var(--primary);
            transform: translateY(-5px);
            box-shadow: var(--shadow);
        }

        .action-icon {
            width: 60px;
            height: 60px;
            border-radius: 12px;
            background: var(--light);
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 15px;
            font-size: 1.5rem;
            color: var(--primary);
        }

        .action-title {
            font-weight: 600;
            margin-bottom: 8px;
            font-size: 1.1rem;
        }

        .action-desc {
            color: var(--gray);
            font-size: 0.9rem;
        }

        /* My Recent Contributions */
        .my-contributions {
            background: white;
            border-radius: var(--border-radius);
            padding: 25px;
            box-shadow: var(--shadow);
            margin-bottom: 30px;
        }

        .contributions-table {
            width: 100%;
            border-collapse: collapse;
        }

        .contributions-table th {
            text-align: left;
            padding: 15px;
            border-bottom: 2px solid var(--gray-light);
            color: var(--gray);
            font-weight: 600;
            font-size: 0.9rem;
        }

        .contributions-table td {
            padding: 15px;
            border-bottom: 1px solid var(--gray-light);
        }

        .contribution-status {
            display: inline-block;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .status-paid {
            background: rgba(0, 200, 81, 0.1);
            color: var(--success);
        }

        .status-pending {
            background: rgba(255, 187, 51, 0.1);
            color: var(--warning);
        }

        .status-overdue {
            background: rgba(255, 68, 68, 0.1);
            color: var(--danger);
        }

        /* Monthly Reports */
        .monthly-reports {
            background: white;
            border-radius: var(--border-radius);
            padding: 25px;
            box-shadow: var(--shadow);
            margin-bottom: 30px;
        }

        .reports-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }

        .report-card {
            border: 2px solid var(--gray-light);
            border-radius: 10px;
            padding: 20px;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .report-icon {
            width: 50px;
            height: 50px;
            border-radius: 10px;
            background: var(--light);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--primary);
            font-size: 1.3rem;
        }

        .report-info {
            flex: 1;
        }

        .report-title {
            font-weight: 600;
            margin-bottom: 5px;
        }

        .report-date {
            color: var(--gray);
            font-size: 0.85rem;
            margin-bottom: 10px;
        }

        /* Upcoming Events */
        .upcoming-events {
            background: white;
            border-radius: var(--border-radius);
            padding: 25px;
            box-shadow: var(--shadow);
        }

        .events-list {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .event-item {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px;
            border-radius: 8px;
            background: var(--light);
        }

        .event-date {
            width: 60px;
            height: 60px;
            border-radius: 10px;
            background: var(--primary);
            color: white;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
        }

        .event-day {
            font-size: 1.5rem;
            font-weight: bold;
            line-height: 1;
        }

        .event-month {
            font-size: 0.8rem;
            opacity: 0.9;
        }

        .event-info {
            flex: 1;
        }

        .event-title {
            font-weight: 600;
            margin-bottom: 5px;
        }

        .event-time {
            color: var(--gray);
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        /* Modal */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .modal {
            background: white;
            border-radius: var(--border-radius);
            padding: 40px;
            max-width: 500px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            transform: translateY(20px);
            transition: transform 0.3s ease;
        }

        .modal-overlay.active .modal {
            transform: translateY(0);
        }

        .modal-header {
            margin-bottom: 25px;
        }

        .modal-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--primary);
            margin-bottom: 10px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--dark);
        }

        input, select, textarea {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid var(--gray-light);
            border-radius: 8px;
            font-size: 1rem;
            transition: all 0.3s ease;
            background-color: white;
        }

        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(46, 91, 255, 0.1);
        }

        /* Footer */
        footer {
            background-color: var(--dark);
            color: white;
            padding: 30px 0 15px;
            margin-top: 50px;
        }

        .footer-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .copyright {
            text-align: center;
            padding-top: 20px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            color: var(--gray);
            font-size: 0.9rem;
        }

        /* Responsive */
        @media (max-width: 1024px) {
            .dashboard-container {
                flex-direction: column;
            }
            
            .sidebar {
                width: 100%;
                height: auto;
                position: static;
                margin-bottom: 20px;
            }
            
            .sidebar-menu {
                display: flex;
                overflow-x: auto;
                padding: 0 15px;
            }
            
            .menu-item {
                flex-direction: column;
                min-width: 100px;
                text-align: center;
                border-left: none;
                border-bottom: 4px solid transparent;
            }
            
            .menu-item.active {
                border-left: none;
                border-bottom-color: var(--primary);
            }
            
            .main-content {
                padding: 20px;
            }
        }

        @media (max-width: 768px) {
            .nav-right {
                gap: 15px;
            }
            
            .language-switcher {
                display: none;
            }
            
            .user-info {
                display: none;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .actions-grid {
                grid-template-columns: 1fr;
            }
            
            .welcome-content h1 {
                font-size: 1.5rem;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header>
        <div class="container">
            <nav class="navbar">
                <a href="index.html" class="logo-container">
                    <div class="logo-icon"></div>
                    <div class="logo-text">My Smart <span>ekimina</span></div>
                </a>
                
                <div class="nav-right">
                    <div class="language-switcher" id="languageSwitcher">
                        <button class="language-btn active" data-lang="en">EN</button>
                        <button class="language-btn" data-lang="rw">RW</button>
                        <button class="language-btn" data-lang="fr">FR</button>
                    </div>
                    
                    <div class="user-profile" id="userProfile">
                        <div class="user-avatar">JM</div>
                        <div class="user-info">
                            <div class="user-name">Jean Marie</div>
                            <div class="user-role" data-en="Member" data-rw="Umwe mu Banyamuryango" data-fr="Membre">Member</div>
                        </div>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                </div>
            </nav>
        </div>
    </header>

    <!-- Dashboard Container -->
    <div class="dashboard-container">
        <!-- Sidebar -->
        <div class="sidebar">
            <div class="sidebar-header">
                <div class="sidebar-title" data-en="Kigali Business Circle" data-rw="Itsinda ry'Ubucuruzi Kigali" data-fr="Cercle d'Affaires de Kigali">Kigali Business Circle</div>
                <div class="sidebar-subtitle" data-en="Tontine Member" data-rw="Umwe mu Banyamuryango" data-fr="Membre Tontine">Tontine Member</div>
            </div>
            
            <ul class="sidebar-menu">
                <li class="menu-item active" onclick="switchMenu('dashboard')">
                    <div class="menu-icon"><i class="fas fa-tachometer-alt"></i></div>
                    <div class="menu-text" data-en="Dashboard" data-rw="Ikibaho" data-fr="Tableau de Bord">Dashboard</div>
                </li>
                <li class="menu-item" onclick="switchMenu('payments')">
                    <div class="menu-icon"><i class="fas fa-money-bill-wave"></i></div>
                    <div class="menu-text" data-en="Make Payment" data-rw="Kwishyura" data-fr="Faire un Paiement">Make Payment</div>
                </li>
                <li class="menu-item" onclick="switchMenu('history')">
                    <div class="menu-icon"><i class="fas fa-history"></i></div>
                    <div class="menu-text" data-en="My Contributions" data-rw="Uruhare Rwanjye" data-fr="Mes Contributions">My Contributions</div>
                </li>
                <li class="menu-item" onclick="switchMenu('reports')">
                    <div class="menu-icon"><i class="fas fa-file-invoice-dollar"></i></div>
                    <div class="menu-text" data-en="My Reports" data-rw="Raporo Zanjye" data-fr="Mes Rapports">My Reports</div>
                </li>
                <li class="menu-item" onclick="switchMenu('notifications')">
                    <div class="menu-icon"><i class="fas fa-bell"></i></div>
                    <div class="menu-text" data-en="Notifications" data-rw="Amatangazo" data-fr="Notifications">Notifications</div>
                    <div class="menu-badge" id="notificationCount">3</div>
                </li>
                <li class="menu-item" onclick="switchMenu('events')">
                    <div class="menu-icon"><i class="fas fa-calendar-alt"></i></div>
                    <div class="menu-text" data-en="Upcoming Events" data-rw="Ibyabaye" data-fr="Événements à Venir">Upcoming Events</div>
                </li>
                <li class="menu-item" onclick="switchMenu('profile')">
                    <div class="menu-icon"><i class="fas fa-user"></i></div>
                    <div class="menu-text" data-en="My Profile" data-rw="Umwirondoro Wanjye" data-fr="Mon Profil">My Profile</div>
                </li>
                <li class="menu-item" onclick="logout()">
                    <div class="menu-icon"><i class="fas fa-sign-out-alt"></i></div>
                    <div class="menu-text" data-en="Logout" data-rw="Sohoka" data-fr="Déconnexion">Logout</div>
                </li>
            </ul>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Dashboard Section -->
            <div id="dashboard-section">
            <!-- Welcome Banner -->
            <div class="welcome-banner">
                <div class="welcome-content">
                    <h1 data-en="Welcome back, Jean Marie!" data-rw="Murakaza neza, Yohani Mariya!" data-fr="Bon retour, Jean Marie!">Welcome back, Jean Marie!</h1>
                    <p data-en="Here's your personal dashboard. Track your contributions, make payments, and stay updated with your tontine." 
                       data-rw="Dore ikibaho cyawe. Kurikirana uruhare rwawe, kwishyura, no kumenya ibyabaye mu kimina cyawe." 
                       data-fr="Voici votre tableau de bord personnel. Suivez vos contributions, effectuez des paiements et restez informé de votre tontine.">
                       Here's your personal dashboard. Track your contributions, make payments, and stay updated with your tontine.
                    </p>
                    <button class="btn btn-primary btn-icon" onclick="openPaymentModal()">
                        <i class="fas fa-money-bill-wave"></i>
                        <span data-en="Make Payment Now" data-rw="Kwishyura Noneho" data-fr="Faire un Paiement Maintenant">Make Payment Now</span>
                    </button>
                </div>
            </div>

            <!-- Stats Grid -->
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon" style="background: var(--primary);">
                        <i class="fas fa-wallet"></i>
                    </div>
                    <div class="stat-info">
                        <div class="stat-label" data-en="My Today's Contribution" data-rw="Uruhare Rwanjye rwa None" data-fr="Ma Contribution d'Aujourd'hui">My Today's Contribution</div>
                        <div class="stat-value">0 RWF</div>
                        <div class="stat-change negative">
                            <i class="fas fa-clock"></i>
                            <span data-en="Due today" data-rw="Urakenewe uyu munsi" data-fr="Dû aujourd'hui">Due today</span>
                        </div>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-icon" style="background: var(--success);">
                        <i class="fas fa-chart-line"></i>
                    </div>
                    <div class="stat-info">
                        <div class="stat-label" data-en="My Total Contributions" data-rw="Uruhare Rwanjye Rwose" data-fr="Mes Contributions Totales">My Total Contributions</div>
                        <div class="stat-value">600,000 RWF</div>
                        <div class="stat-change positive">
                            <i class="fas fa-arrow-up"></i>
                            <span data-en="Good standing" data-rw="Imiterere nziza" data-fr="Bon statut">Good standing</span>
                        </div>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-icon" style="background: var(--warning);">
                        <i class="fas fa-calendar-check"></i>
                    </div>
                    <div class="stat-info">
                        <div class="stat-label" data-en="Next Meeting" data-rw="Inama Ikurikira" data-fr="Prochaine Réunion">Next Meeting</div>
                        <div class="stat-value">Dec 15, 2023</div>
                        <div class="stat-change">
                            <i class="fas fa-clock"></i>
                            <span data-en="In 3 days" data-rw="Mu minsi 3" data-fr="Dans 3 jours">In 3 days</span>
                        </div>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-icon" style="background: var(--secondary);">
                        <i class="fas fa-percentage"></i>
                    </div>
                    <div class="stat-info">
                        <div class="stat-label" data-en="My Performance" data-rw="Ibyiza Byanjye" data-fr="Ma Performance">My Performance</div>
                        <div class="stat-value">100%</div>
                        <div class="stat-change positive">
                            <i class="fas fa-trophy"></i>
                            <span data-en="Perfect record" data-rw="Icyiza cyuzuye" data-fr="Record parfait">Perfect record</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Quick Actions -->
            <div class="quick-actions">
                <div class="section-header">
                    <div class="section-title" data-en="Quick Actions" data-rw="Ibikorwa byihuse" data-fr="Actions Rapides">Quick Actions</div>
                </div>
                
                <div class="actions-grid">
                    <div class="action-card" onclick="openPaymentModal()">
                        <div class="action-icon">
                            <i class="fas fa-money-bill-wave"></i>
                        </div>
                        <div class="action-title" data-en="Make Payment" data-rw="Kwishyura" data-fr="Faire un Paiement">Make Payment</div>
                        <div class="action-desc" data-en="Pay your tontine contribution" data-rw="Shyira uruhare rwawe mu kimina" data-fr="Payez votre contribution tontine">Pay your tontine contribution</div>
                    </div>

                    <div class="action-card" onclick="downloadMyReport('monthly')">
                        <div class="action-icon">
                            <i class="fas fa-file-download"></i>
                        </div>
                        <div class="action-title" data-en="Download Report" data-rw="Kuramo Raporo" data-fr="Télécharger Rapport">Download Report</div>
                        <div class="action-desc" data-en="My monthly contribution report" data-rw="Raporo y'ukwezi y'uruhare rwanjye" data-fr="Mon rapport mensuel de contribution">My monthly contribution report</div>
                    </div>

                    <div class="action-card" onclick="viewMyContributions()">
                        <div class="action-icon">
                            <i class="fas fa-history"></i>
                        </div>
                        <div class="action-title" data-en="View My History" data-rw="Reba Amateka Yanjye" data-fr="Voir Mon Historique">View My History</div>
                        <div class="action-desc" data-en="Check all my contributions" data-rw="Reba uruhare rwanjye rwose" data-fr="Voir toutes mes contributions">Check all my contributions</div>
                    </div>

                    <div class="action-card" onclick="contactAdmin()">
                        <div class="action-icon">
                            <i class="fas fa-headset"></i>
                        </div>
                        <div class="action-title" data-en="Contact Admin" data-rw="Vugana n'Ubuyobozi" data-fr="Contacter l'Admin">Contact Admin</div>
                        <div class="action-desc" data-en="Message tontine administrator" data-rw="Ohereza ubutumwa k'umuyobozi" data-fr="Message à l'administrateur">Message tontine administrator</div>
                    </div>
                </div>
            </div>

            <!-- My Recent Contributions -->
            <div class="my-contributions" id="contributions-section">
                <div class="section-header">
                    <div class="section-title" data-en="My Recent Contributions" data-rw="Uruhare Rwanjye rwa Vuba" data-fr="Mes Contributions Récentes">My Recent Contributions</div>
                    <button class="btn btn-secondary btn-sm" onclick="viewAllMyContributions()" data-en="View All" data-rw="Reba Byose" data-fr="Voir Tout">View All</button>
                </div>
                
                <div class="table-responsive">
                    <table class="contributions-table">
                        <thead>
                            <tr>
                                <th data-en="Date" data-rw="Itariki" data-fr="Date">Date</th>
                                <th data-en="Amount" data-rw="Amafaranga" data-fr="Montant">Amount</th>
                                <th data-en="Payment Method" data-rw="Uburyo bwo Kwishyura" data-fr="Méthode de Paiement">Payment Method</th>
                                <th data-en="Status" data-rw="Imiterere" data-fr="Statut">Status</th>
                                <th data-en="Receipt" data-rw="Resi" data-fr="Reçu">Receipt</th>
                            </tr>
                        </thead>
                        <tbody id="myContributionsTableBody">
                            <tr>
                                <td colspan="5" style="text-align: center; padding: 40px; color: var(--gray);">
                                    <i class="fas fa-spinner fa-spin" style="font-size: 36px; margin-bottom: 10px;"></i>
                                    <p data-en="Loading your contributions..." data-rw="Gutanga uruhare rwanjye..." data-fr="Chargement de vos contributions...">Loading your contributions...</p>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Monthly Reports -->
            <div class="monthly-reports" id="reports-section">
                <div class="section-header">
                    <div class="section-title" data-en="My Monthly Reports" data-rw="Raporo Zanjye z'Ukwezi" data-fr="Mes Rapports Mensuels">My Monthly Reports</div>
                </div>
                
                <div class="reports-grid">
                    <div class="report-card">
                        <div class="report-icon">
                            <i class="fas fa-file-pdf"></i>
                        </div>
                        <div class="report-info">
                            <div class="report-title" data-en="November 2023 Report" data-rw="Raporo ya Ukwakira 2023" data-fr="Rapport Novembre 2023">November 2023 Report</div>
                            <div class="report-date" data-en="Generated: Dec 1, 2023" data-rw="Yatangiye: 1 Mutarama 2023" data-fr="Généré: 1 Déc 2023">Generated: Dec 1, 2023</div>
                            <button class="btn btn-sm btn-primary" onclick="downloadReport('nov2023')" data-en="Download" data-rw="Kuramo" data-fr="Télécharger">Download</button>
                        </div>
                    </div>

                    <div class="report-card">
                        <div class="report-icon">
                            <i class="fas fa-file-pdf"></i>
                        </div>
                        <div class="report-info">
                            <div class="report-title" data-en="October 2023 Report" data-rw="Raporo ya Ugushyingo 2023" data-fr="Rapport Octobre 2023">October 2023 Report</div>
                            <div class="report-date" data-en="Generated: Nov 1, 2023" data-rw="Yatangiye: 1 Ukuboza 2023" data-fr="Généré: 1 Nov 2023">Generated: Nov 1, 2023</div>
                            <button class="btn btn-sm btn-primary" onclick="downloadReport('oct2023')" data-en="Download" data-rw="Kuramo" data-fr="Télécharger">Download</button>
                        </div>
                    </div>

                    <div class="report-card">
                        <div class="report-icon">
                            <i class="fas fa-file-pdf"></i>
                        </div>
                        <div class="report-info">
                            <div class="report-title" data-en="September 2023 Report" data-rw="Raporo ya Nzeli 2023" data-fr="Rapport Septembre 2023">September 2023 Report</div>
                            <div class="report-date" data-en="Generated: Oct 1, 2023" data-rw="Yatangiye: 1 Ukwakira 2023" data-fr="Généré: 1 Oct 2023">Generated: Oct 1, 2023</div>
                            <button class="btn btn-sm btn-primary" onclick="downloadReport('sep2023')" data-en="Download" data-rw="Kuramo" data-fr="Télécharger">Download</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Upcoming Events -->
            <div class="upcoming-events" id="events-section">
                <div class="section-header">
                    <div class="section-title" data-en="Upcoming Events" data-rw="Ibyabaye" data-fr="Événements à Venir">Upcoming Events</div>
                    <button class="btn btn-secondary btn-sm" onclick="viewAllEvents()" data-en="View Calendar" data-rw="Reba Kalendari" data-fr="Voir Calendrier">View Calendar</button>
                </div>
                
                <div class="events-list">
                    <div class="event-item">
                        <div class="event-date">
                            <div class="event-day">15</div>
                            <div class="event-month" data-en="Dec" data-rw="Mutarama" data-fr="Déc">Dec</div>
                        </div>
                        <div class="event-info">
                            <div class="event-title" data-en="Monthly Tontine Meeting" data-rw="Inama y'Ukwezi y'ekimina" data-fr="Réunion Mensuelle Tontine">Monthly Tontine Meeting</div>
                            <div class="event-time">
                                <i class="far fa-clock"></i>
                                <span data-en="2:00 PM - Kigali Conference Center" data-rw="14:00 - Icyicaro cya Kigali" data-fr="14:00 - Centre de Conférence de Kigali">2:00 PM - Kigali Conference Center</span>
                            </div>
                        </div>
                    </div>

                    <div class="event-item">
                        <div class="event-date">
                            <div class="event-day">20</div>
                            <div class="event-month" data-en="Dec" data-rw="Mutarama" data-fr="Déc">Dec</div>
                        </div>
                        <div class="event-info">
                            <div class="event-title" data-en="Contribution Deadline" data-rw="Igihe cyo Kwishyura" data-fr="Date Limite de Contribution">Contribution Deadline</div>
                            <div class="event-time">
                                <i class="fas fa-exclamation-circle"></i>
                                <span data-en="All December payments due" data-rw="Amafaranga ya Nzeli yose akenewe" data-fr="Tous les paiements de décembre dus">All December payments due</span>
                            </div>
                        </div>
                    </div>

                    <div class="event-item">
                        <div class="event-date">
                            <div class="event-day">25</div>
                            <div class="event-month" data-en="Dec" data-rw="Mutarama" data-fr="Déc">Dec</div>
                        </div>
                        <div class="event-info">
                            <div class="event-title" data-en="Christmas Social Event" data-rw="Umuganda w'Ikiriho" data-fr="Événement Social de Noël">Christmas Social Event</div>
                            <div class="event-time">
                                <i class="fas fa-glass-cheers"></i>
                                <span data-en="6:00 PM - Member's Residence" data-rw="18:00 - Aho umwe mu banyamuryango aba" data-fr="18:00 - Résidence d'un Membre">6:00 PM - Member's Residence</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            </div>
        </div>
    </div>

    <!-- Payment Modal -->
    <div class="modal-overlay" id="paymentModal">
        <div class="modal">
            <div class="modal-header">
                <div class="modal-title" data-en="Make Payment" data-rw="Kwishyura" data-fr="Faire un Paiement">Make Payment</div>
                <p data-en="Pay your tontine contribution and upload receipt for leader approval" data-rw="Shyira uruhare rwawe mu kimina no gutangiza resi kugirango umuyobozi akemure" data-fr="Payez votre contribution tontine et téléchargez le reçu pour approbation du leader">Pay your tontine contribution and upload receipt for leader approval</p>
            </div>
            
            <div class="form-group">
                <label for="paymentAmount" data-en="Amount (RWF)" data-rw="Amafaranga (RWF)" data-fr="Montant (RWF)">Amount (RWF)</label>
                <input type="number" id="paymentAmount" value="50000" min="50000" step="1000">
                <small style="color: var(--gray); font-size: 0.85rem;" data-en="Minimum: 50,000 RWF" data-rw="Amafaranga make: 50,000 RWF" data-fr="Minimum: 50,000 RWF">Minimum: 50,000 RWF</small>
            </div>
            
            <div class="form-group">
                <label for="paymentMethod" data-en="Payment Method" data-rw="Uburyo bwo Kwishyura" data-fr="Méthode de Paiement">Payment Method</label>
                <select id="paymentMethod">
                    <option value="mobile" data-en="Mobile Money" data-rw="Amafaranga ya Telefone" data-fr="Mobile Money">Mobile Money</option>
                    <option value="bank" data-en="Bank Transfer" data-rw="Kohereza ku Banki" data-fr="Virement Bancaire">Bank Transfer</option>
                    <option value="cash" data-en="Cash" data-rw="Amafaranga" data-fr="Espèces">Cash</option>
                </select>
            </div>
            
            <div class="form-group" id="mobileNumberField" style="display: block;">
                <label for="mobileNumber" data-en="Mobile Number" data-rw="Numero ya Telefone" data-fr="Numéro de Mobile">Mobile Number</label>
                <input type="tel" id="mobileNumber" placeholder="0781234567">
            </div>
            
            <div class="form-group" id="bankDetailsField" style="display: none;">
                <label for="bankDetails" data-en="Bank Account Details" data-rw="Amakuru ya Konti ya Banki" data-fr="Détails du Compte Bancaire">Bank Account Details</label>
                <textarea id="bankDetails" rows="3" placeholder="Account number, bank name, etc." data-placeholder-en="Account number, bank name, etc." data-placeholder-rw="Numero ya konti, izina ry'banki, n'ibindi" data-placeholder-fr="Numéro de compte, nom de banque, etc."></textarea>
            </div>
            
            <!-- Payment Receipt Upload -->
            <div class="form-group" style="border: 2px dashed var(--primary); border-radius: 8px; padding: 20px; background: var(--gray-light);">
                <label for="paymentReceipt" style="font-weight: 600; margin-bottom: 10px; display: block;">
                    <i class="fas fa-upload" style="margin-right: 8px;"></i>
                    <span data-en="Upload Payment Receipt" data-rw="Gutangiza Resi y'Ubwishyure" data-fr="Télécharger le Reçu de Paiement">Upload Payment Receipt</span>
                </label>
                <p style="font-size: 0.9rem; color: var(--gray); margin-bottom: 15px;" data-en="Upload a screenshot, photo, or PDF of your payment receipt. This will be sent to the group leader for verification." data-rw="Gutangiza ifoto, imigize, cyangwa PDF y'uresi rwawe. Iyo igiye kohereza kumuyobozi wakoranye kugirango akemure." data-fr="Téléchargez une capture d'écran, une photo ou un PDF de votre reçu. Ceci sera envoyé au leader du groupe pour vérification.">Upload a screenshot, photo, or PDF of your payment receipt. This will be sent to the group leader for verification.</p>
                
                <!-- File Input -->
                <input type="file" id="paymentReceipt" accept=".pdf,.jpg,.jpeg,.png" style="display: none;">
                
                <!-- File Upload Area -->
                <div id="receiptUploadArea" onclick="document.getElementById('paymentReceipt').click()" style="border: 2px dashed var(--primary); border-radius: 8px; padding: 30px; text-align: center; cursor: pointer; transition: all 0.3s ease;" onmouseover="this.style.background = 'var(--primary)'; this.style.color = 'white';" onmouseout="this.style.background = 'transparent'; this.style.color = 'inherit';">
                    <i class="fas fa-cloud-upload-alt" style="font-size: 2.5rem; margin-bottom: 10px; display: block;"></i>
                    <span class="upload-text" data-en="Click to upload or drag and drop" data-rw="Kanda kugirango utangize cyangwa gukuramo" data-fr="Cliquez pour télécharger ou glissez-déposez">Click to upload or drag and drop</span>
                    <p style="font-size: 0.85rem; margin-top: 8px; opacity: 0.7;" data-en="PDF, JPG, PNG (Max 5MB)" data-rw="PDF, JPG, PNG (Max 5MB)" data-fr="PDF, JPG, PNG (Max 5MB)">PDF, JPG, PNG (Max 5MB)</p>
                </div>
                
                <!-- File Preview -->
                <div id="receiptPreview" style="display: none; margin-top: 15px; padding: 15px; background: white; border-radius: 8px; border: 1px solid var(--primary);">
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <div>
                            <i class="fas fa-check-circle" style="color: var(--success); margin-right: 10px;"></i>
                            <span id="receiptFileName" style="font-weight: 600;"></span>
                        </div>
                        <button type="button" onclick="clearReceiptUpload()" class="btn btn-sm btn-secondary" data-en="Remove" data-rw="Gusiba" data-fr="Supprimer">Remove</button>
                    </div>
                </div>
                
                <small style="color: var(--warning); display: block; margin-top: 10px; font-weight: 500;">
                    <i class="fas fa-info-circle"></i>
                    <span data-en="Important: Receipt will be verified by the group leader before recording" data-rw="Ngombwa: Resi ikemurwa n'umuyobozi wakoranye mbere yo kugereranya" data-fr="Important: Le reçu sera vérifié par le leader du groupe avant enregistrement">Important: Receipt will be verified by the group leader before recording</span>
                </small>
            </div>
            
            <div style="display: flex; gap: 15px; margin-top: 30px;">
                <button class="btn btn-secondary" style="flex: 1;" onclick="closePaymentModal()" data-en="Cancel" data-rw="Hagarika" data-fr="Annuler">Cancel</button>
                <button class="btn btn-primary" style="flex: 1;" onclick="submitPaymentRequest()" data-en="Send Request" data-rw="Ohereza Ibiryano" data-fr="Envoyer la Demande">Send Request</button>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="logo-container">
                    <div class="logo-icon"></div>
                    <div class="logo-text">My Smart <span>ekimina</span></div>
                </div>
                <div>
                    <a href="#" style="color: white; margin-left: 20px;"><i class="fas fa-question-circle"></i> 
                        <span data-en="Help Center" data-rw="Ubufasha" data-fr="Centre d'aide">Help Center</span>
                    </a>
                    <a href="#" style="color: white; margin-left: 20px;"><i class="fas fa-phone"></i> 
                        <span data-en="Contact Support" data-rw="Vugana n'Abafasha" data-fr="Contactez le support">Contact Support</span>
                    </a>
                </div>
            </div>
            <div class="copyright">
                <p>&copy; 2023 My Smart ekimina. 
                    <a href="#" style="color: var(--secondary);" data-en="Privacy Policy" data-rw="Politiki y'Ibanga" data-fr="Politique de confidentialité">Privacy Policy</a> | 
                    <a href="#" style="color: var(--secondary);" data-en="Terms of Service" data-rw="Amategeko y'Uburyo" data-fr="Conditions d'utilisation">Terms of Service</a>
                </p>
            </div>
        </div>
    </footer>

    <!-- API Configuration -->
    <script src="js/api.js"></script>
    <script src="js/integration-helper.js"></script>
    <script src="js/app-init.js"></script>

    <script>
        // Current language
        let currentLanguage = 'en';

        // Language switching function
        function switchLanguage(lang) {
            currentLanguage = lang;
            
            // Update all elements with data attributes
            document.querySelectorAll('[data-en], [data-rw], [data-fr]').forEach(element => {
                if (element.dataset[lang]) {
                    element.textContent = element.dataset[lang];
                }
            });
            
            // Update all input placeholders
            document.querySelectorAll('[data-placeholder-en], [data-placeholder-rw], [data-placeholder-fr]').forEach(input => {
                // Convert 'en' to 'En', 'rw' to 'Rw', 'fr' to 'Fr' for camelCase dataset property
                const placeholderKey = 'placeholder' + lang.charAt(0).toUpperCase() + lang.slice(1);
                if (input.dataset[placeholderKey]) {
                    input.placeholder = input.dataset[placeholderKey];
                }
            });
            
            // Update page title
            const title = document.querySelector('title');
            if (title.dataset[lang]) {
                title.textContent = title.dataset[lang];
            }
            
            // Update active language button
            document.querySelectorAll('.language-btn').forEach(btn => {
                btn.classList.remove('active');
                if (btn.dataset.lang === lang) {
                    btn.classList.add('active');
                }
            });
            
            // Save language preference
            localStorage.setItem('preferredLanguage', lang);
        }

        // Load and display user data
        function loadUserData() {
            const user = TokenManager.getUser();
            if (!user) {
                window.location.href = 'login.html';
                return;
            }
            
            // Update user name in header
            const userName = `${user.firstName || ''} ${user.lastName || ''}`.trim() || user.email || 'User';
            const userNameEl = document.querySelector('.user-name');
            if (userNameEl) {
                userNameEl.textContent = userName;
            }
            
            // Update user initials in avatar
            const initials = getUserInitials(userName);
            const userAvatar = document.querySelector('.user-avatar');
            if (userAvatar) {
                userAvatar.textContent = initials;
            }
            
            // Update welcome message
            const welcomeHeading = document.querySelector('.welcome-banner h1');
            if (welcomeHeading) {
                welcomeHeading.textContent = `Welcome back, ${userName}!`;
                welcomeHeading.dataset.en = `Welcome back, ${userName}!`;
                welcomeHeading.dataset.rw = `Murakaza neza, ${userName}!`;
                welcomeHeading.dataset.fr = `Bon retour, ${userName}!`;
            }
            
            // Update user role if available
            const userRoleEl = document.querySelector('.user-role');
            if (userRoleEl && user.role) {
                const roleDisplay = user.role === 'site_admin' ? 'Administrator' : 
                                   user.role === 'group_leader' ? 'Group Leader' : 'Member';
                userRoleEl.textContent = roleDisplay;
                userRoleEl.dataset.en = roleDisplay;
            }
        }
        
        // Get user initials from name
        function getUserInitials(name) {
            const parts = name.trim().split(' ');
            if (parts.length >= 2) {
                return (parts[0][0] + parts[parts.length - 1][0]).toUpperCase();
            } else if (parts.length === 1 && parts[0].length > 0) {
                return parts[0].substring(0, 2).toUpperCase();
            }
            return 'U';
        }
        
        // Load user's contributions from API
        function loadMyContributions() {
            const user = TokenManager.getUser();
            if (!user) {
                console.warn('No user found');
                return;
            }
            
            console.log('Loading contributions for user:', user.id);
            
            // First, fetch the user's groups
            fetch('http://localhost:5000/api/groups', {
                headers: {
                    'Authorization': 'Bearer ' + localStorage.getItem('authToken')
                }
            })
            .then(response => {
                if (!response.ok) throw new Error('Failed to fetch groups');
                return response.json();
            })
            .then(groupsData => {
                console.log('Groups API response:', groupsData);
                
                // Get all groups
                const groups = (groupsData && groupsData.groups) ? groupsData.groups : (Array.isArray(groupsData) ? groupsData : []);
                console.log('Total groups in system:', groups.length);
                
                if (groups.length === 0) {
                    console.log('No groups found in system');
                    const tbody = document.getElementById('myContributionsTableBody');
                    if (tbody) {
                        tbody.innerHTML = `<tr><td colspan="5" style="text-align: center; padding: 40px; color: var(--gray);"><i class="fas fa-inbox" style="font-size: 36px; margin-bottom: 10px;"></i><p>No groups available</p></td></tr>`;
                    }
                    return;
                }
                
                // Get user's groups - user belongs if they're a member OR leader
                const userGroups = groups.filter(g => {
                    const isLeader = g.leader_id === user.id;
                    const isMember = (g.members && Array.isArray(g.members) && g.members.some(m => 
                        (m.user_id === user.id) || (m.id === user.id)
                    ));
                    return isLeader || isMember;
                });
                
                console.log('User groups found:', userGroups.length, 'out of', groups.length);
                console.log('User groups:', userGroups.map(g => ({ id: g.id, name: g.name, leader_id: g.leader_id })));
                
                // If no user-specific groups, show ALL groups (in case membership info is stored differently)
                const groupsToFetch = userGroups.length > 0 ? userGroups : groups;
                console.log('Fetching contributions from', groupsToFetch.length, 'groups');
                
                // Fetch contributions from all relevant groups
                const contributionPromises = groupsToFetch.map(group =>
                    fetch('http://localhost:5000/api/contributions?groupId=' + group.id, {
                        headers: {
                            'Authorization': 'Bearer ' + localStorage.getItem('authToken')
                        }
                    })
                    .then(response => {
                        if (!response.ok) return [];
                        return response.json();
                    })
                    .catch(error => {
                        console.error('Error fetching contributions for group ' + group.id, error);
                        return [];
                    })
                );
                
                return Promise.all(contributionPromises);
            })
            .then(contributionArrays => {
                // Flatten and filter contributions for this user
                let allContributions = [];
                let allContributionsUnfiltered = [];
                
                if (Array.isArray(contributionArrays)) {
                    for (const contribData of contributionArrays) {
                        let contributions = [];
                        if (Array.isArray(contribData)) {
                            contributions = contribData;
                        } else if (contribData && contribData.contributions) {
                            contributions = contribData.contributions;
                        } else if (contribData && contribData.data) {
                            contributions = contribData.data;
                        }
                        
                        allContributionsUnfiltered = allContributionsUnfiltered.concat(contributions);
                        
                        console.log('Contributions from this group:', contributions.length);
                        if (contributions.length > 0) {
                            console.log('Sample contribution:', contributions[0]);
                        }
                        
                        // Filter for current user's contributions
                        const userContribs = contributions.filter(c => {
                            if (c.user_id && c.user_id === user.id) return true;
                            if (c.first_name && c.last_name && user.first_name && user.last_name) {
                                if (c.first_name.toLowerCase() === user.first_name.toLowerCase() && 
                                    c.last_name.toLowerCase() === user.last_name.toLowerCase()) {
                                    return true;
                                }
                            }
                            if (c.email && user.email && c.email.toLowerCase() === user.email.toLowerCase()) {
                                return true;
                            }
                            return false;
                        });
                        
                        allContributions = allContributions.concat(userContribs);
                    }
                }
                
                console.log('Total contributions in all groups:', allContributionsUnfiltered.length);
                console.log('Total user-matched contributions:', allContributions.length);
                console.log('Current user object:', user);
                
                // If no matches found, show all contributions (they may be for this user even if not explicitly matched)
                if (allContributions.length === 0 && allContributionsUnfiltered.length > 0) {
                    console.log('No user-specific match found. Showing all contributions.');
                    allContributions = allContributionsUnfiltered;
                }
                
                // Sort by date, newest first
                allContributions.sort((a, b) => {
                    const dateA = new Date(a.created_at || 0);
                    const dateB = new Date(b.created_at || 0);
                    return dateB - dateA;
                });
                
                // Display in table
                const tbody = document.getElementById('myContributionsTableBody');
                if (!tbody) {
                    console.warn('Contributions table body not found');
                    return;
                }
                
                if (allContributions.length === 0) {
                    tbody.innerHTML = `<tr><td colspan="5" style="text-align: center; padding: 40px; color: var(--gray);"><i class="fas fa-inbox" style="font-size: 36px; margin-bottom: 10px;"></i><p>No contributions yet</p></td></tr>`;
                    return;
                }
                
                tbody.innerHTML = allContributions.map(contrib => {
                    const date = new Date(contrib.created_at).toLocaleDateString();
                    const amount = (contrib.amount || 0).toLocaleString() + ' RWF';
                    const method = contrib.payment_method 
                        ? contrib.payment_method.charAt(0).toUpperCase() + contrib.payment_method.slice(1)
                        : 'Contribution';
                    const statusBadge = contrib.status === 'approved'
                        ? '<span class="contribution-status status-paid">Paid</span>'
                        : '<span class="contribution-status status-pending">Pending</span>';
                    const receiptBtn = contrib.receipt_url
                        ? `<button class="btn btn-sm btn-secondary" onclick="downloadReceipt('${contrib.id}')"><i class="fas fa-download"></i></button>`
                        : '';
                    
                    return `
                        <tr>
                            <td>${date}</td>
                            <td>${amount}</td>
                            <td>${method}</td>
                            <td>${statusBadge}</td>
                            <td>${receiptBtn}</td>
                        </tr>
                    `;
                }).join('');
            })
            .catch(error => {
                console.error('Error loading contributions:', error);
                const tbody = document.getElementById('myContributionsTableBody');
                if (tbody) {
                    tbody.innerHTML = `<tr><td colspan="5" style="text-align: center; padding: 40px; color: var(--danger);"><i class="fas fa-exclamation-circle" style="font-size: 36px; margin-bottom: 10px;"></i><p>Error loading contributions: ${error.message}</p></td></tr>`;
                }
            });
        }

        // Initialize language
        document.addEventListener('DOMContentLoaded', async function() {
            console.log('=== User Dashboard Initializing ===');
            
            // Check if user is logged in
            if (!TokenManager.isLoggedIn()) {
                console.log('User not logged in, redirecting to login');
                window.location.href = 'login.html';
                return;
            }
            
            const user = TokenManager.getUser();
            console.log('Logged in user:', user);
            console.log('User role:', user.role);
            
            console.log('=== STRICT APPROVAL CHECK: Only approved users allowed ===');
            
            // Skip approval check for site admins only
            if (user.role === 'site_admin') {
                console.log('✅ User is a site admin, granting access');
            } else {
                // For everyone else (including group_leader and member), MANDATORY approval status check
                try {
                    console.log('🔍 STRICT: Checking membership approval status...');
                    const groupsResponse = await GroupsAPI.getAll();
                    console.log('=== RAW Groups Response ===');
                    console.log('Full response:', groupsResponse);
                    console.log('Response keys:', Object.keys(groupsResponse || {}));
                    console.log('Response JSON:', JSON.stringify(groupsResponse, null, 2));
                    
                    // Try multiple possible response structures
                    let groups = null;
                    if (groupsResponse && Array.isArray(groupsResponse)) {
                        console.log('✅ Response is directly an array');
                        groups = groupsResponse;
                    } else if (groupsResponse && groupsResponse.groups && Array.isArray(groupsResponse.groups)) {
                        console.log('✅ Response has .groups property');
                        groups = groupsResponse.groups;
                    } else if (groupsResponse && groupsResponse.data && Array.isArray(groupsResponse.data)) {
                        console.log('✅ Response has .data property');
                        groups = groupsResponse.data;
                    } else {
                        console.error('❌ Invalid groups response structure');
                        console.error('Expected one of: [array], {groups: [array]}, {data: [array]}');
                        console.error('Got:', groupsResponse);
                        alert('Access Denied: Unable to verify your membership status. Please contact support.');
                        window.location.href = 'login.html';
                        return;
                    }
                    
                    if (!groups || !Array.isArray(groups)) {
                        console.error('❌ Groups is not an array after extraction');
                        alert('Access Denied: Unable to verify your membership status. Please contact support.');
                        window.location.href = 'login.html';
                        return;
                    }
                    
                    console.log(`✅ Found ${groups.length} groups to check`);
                    
                    // Store groups for easier reference
                    const groupsResponse_corrected = groups;
                    
                    // STRICT CHECK: User MUST have at least one APPROVED membership
                    let hasApprovedMembership = false;
                    let foundUserInAnyGroup = false;
                    let userMemberships = [];
                    
                    for (const group of groupsResponse_corrected) {
                        console.log(`\n📍 Checking group: "${group.name}"`);
                        console.log('  Group ID:', group.id || group._id);
                        console.log('  Group leader ID:', group.leader_id || group.leaderId);
                        console.log('  Current user ID:', user.id);
                        
                        // Group leaders are auto-approved for their own groups
                        // Handle different property name variations
                        const groupLeaderId = group.leader_id || group.leaderId || group.lead_id;
                        if (groupLeaderId === user.id) {
                            console.log(`  ✅ User is leader of group "${group.name}", auto-approved`);
                            hasApprovedMembership = true;
                            userMemberships.push({
                                groupName: group.name,
                                status: 'approved',
                                reason: 'leader'
                            });
                            break;
                        }
                        
                        // Check members array - handle different structure possibilities
                        let members = group.members;
                        if (!members || members.length === 0) {
                            console.log(`  ⚠️ No members in group object, fetching from API...`);
                            // If members not included in getAll() response, fetch separately
                            try {
                                const membersResponse = await GroupsAPI.getMembers(group.id || group._id);
                                console.log(`  📥 Fetched members from API:`, membersResponse);
                                
                                if (Array.isArray(membersResponse)) {
                                    members = membersResponse;
                                } else if (membersResponse && Array.isArray(membersResponse.members)) {
                                    members = membersResponse.members;
                                } else if (membersResponse && Array.isArray(membersResponse.data)) {
                                    members = membersResponse.data;
                                } else {
                                    console.log(`  ⚠️ Members API response not in expected format:`, membersResponse);
                                    members = [];
                                }
                            } catch (memberError) {
                                console.log(`  ⚠️ Error fetching members for group: ${memberError.message}`);
                                members = [];
                            }
                        }
                        
                        // Try alternative property names if still empty
                        if (!members || members.length === 0) {
                            members = group.users || group.groupMembers || [];
                        }
                        
                        if (!Array.isArray(members)) {
                            console.log(`  ❌ Members is not an array in group "${group.name}"`);
                            console.log('  Members value:', members);
                            continue;
                        }
                        
                        if (members.length === 0) {
                            console.log(`  ℹ️ Group "${group.name}" has no members`);
                            continue;
                        }
                        
                        console.log(`  📋 Checking ${members.length} members in "${group.name}"`);
                        
                        for (const member of members) {
                            // Handle different user ID property names
                            const memberId = member.user_id || member.userId || member.id;
                            const isCurrentUser = memberId === user.id;
                            const memberStatus = member.status || 'pending';
                            
                            // STRICT: Only "approved" or "active" statuses are allowed
                            // "pending" and "rejected" are NOT allowed
                            const isApproved = memberStatus === 'approved' || memberStatus === 'active';
                            
                            console.log(`    - Member ID: ${memberId}, Status: "${memberStatus}", IsCurrentUser: ${isCurrentUser}`);
                            
                            if (isCurrentUser) {
                                foundUserInAnyGroup = true;
                                userMemberships.push({
                                    groupName: group.name,
                                    status: memberStatus,
                                    isApproved: isApproved
                                });
                                
                                if (isApproved) {
                                    hasApprovedMembership = true;
                                    console.log(`    ✅ FOUND APPROVED MEMBERSHIP in "${group.name}" (status: "${memberStatus}")`);
                                } else {
                                    console.log(`    ❌ FOUND UNAPPROVED MEMBERSHIP in "${group.name}" (status: "${memberStatus}")`);
                                }
                            }
                        }
                    }
                    
                    console.log('📊 Membership Summary:');
                    console.log('  - Found in groups:', foundUserInAnyGroup);
                    console.log('  - Has approved membership:', hasApprovedMembership);
                    console.log('  - Memberships:', userMemberships);
                    
                    // STRICT ENFORCEMENT: Block access if not approved
                    if (!hasApprovedMembership) {
                        if (!foundUserInAnyGroup) {
                            console.log('❌ ACCESS DENIED: User not found in any group');
                            alert('Access Denied: You are not a member of any tontine group. Please join a group first.');
                            window.location.href = 'register.html';
                            return;
                        } else {
                            console.log('❌ ACCESS DENIED: User exists but has no approved memberships');
                            console.log('Pending memberships:', userMemberships);
                            alert('Access Denied: Your membership is pending approval from the group leader. You will be able to access the dashboard once approved.');
                            window.location.href = 'login.html';
                            return;
                        }
                    }
                    
                    console.log('✅ ACCESS GRANTED: User has approved membership, loading dashboard');
                    
                    // Store the group ID for payment submission
                    // Find the group ID from the first approved membership
                    for (const group of groupsResponse_corrected) {
                        const groupLeaderId = group.leader_id || group.leaderId || group.lead_id;
                        if (groupLeaderId === user.id) {
                            // User is group leader
                            window.currentGroupId = group.id || group._id;
                            console.log('✅ Group ID stored (user is leader):', window.currentGroupId);
                            break;
                        }
                        
                        // Check if user is a member with approved status
                        let members = group.members || group.users || group.groupMembers || [];
                        if (!Array.isArray(members)) {
                            try {
                                const membersResponse = await GroupsAPI.getMembers(group.id || group._id);
                                if (Array.isArray(membersResponse)) {
                                    members = membersResponse;
                                } else if (membersResponse && Array.isArray(membersResponse.members)) {
                                    members = membersResponse.members;
                                } else if (membersResponse && Array.isArray(membersResponse.data)) {
                                    members = membersResponse.data;
                                }
                            } catch (e) {
                                members = [];
                            }
                        }
                        
                        for (const member of members) {
                            const memberId = member.user_id || member.userId || member.id;
                            const memberStatus = member.status || 'pending';
                            const isApproved = memberStatus === 'approved' || memberStatus === 'active';
                            
                            if (memberId === user.id && isApproved) {
                                window.currentGroupId = group.id || group._id;
                                console.log('✅ Group ID stored (user is approved member):', window.currentGroupId);
                                break;
                            }
                        }
                        
                        if (window.currentGroupId) break;
                    }
                    
                    if (!window.currentGroupId) {
                        console.warn('⚠️ Could not determine group ID, using first group');
                        if (groupsResponse_corrected.length > 0) {
                            window.currentGroupId = groupsResponse_corrected[0].id || groupsResponse_corrected[0]._id;
                        }
                    }
                    
                } catch (error) {
                    console.error('❌ CRITICAL: Error checking membership status:', error);
                    console.error('Error stack:', error.stack);
                    // SECURITY FIRST: Deny access on any error
                    alert('Access Denied: Unable to verify your membership status. Please try logging in again or contact support.');
                    window.location.href = 'login.html';
                    return;
                }
            }
            
            // Load user data from localStorage
            loadUserData();
            
            // Load user's contributions from API
            loadMyContributions();
            
            // Load saved language preference
            const savedLang = localStorage.getItem('preferredLanguage') || 'en';
            switchLanguage(savedLang);
            
            // Setup language switcher buttons
            document.querySelectorAll('.language-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    switchLanguage(this.dataset.lang);
                });
            });
            
            // Setup payment method toggle
            document.getElementById('paymentMethod').addEventListener('change', function() {
                const method = this.value;
                document.getElementById('mobileNumberField').style.display = method === 'mobile' ? 'block' : 'none';
                document.getElementById('bankDetailsField').style.display = method === 'bank' ? 'block' : 'none';
            });
            
            // Setup payment receipt file input listener
            document.getElementById('paymentReceipt').addEventListener('change', function(e) {
                const file = this.files[0];
                if (file) {
                    // Validate file type
                    const validTypes = ['image/jpeg', 'image/png', 'application/pdf'];
                    if (!validTypes.includes(file.type)) {
                        alert('Please select a PDF or image file (JPG, PNG)');
                        this.value = '';
                        return;
                    }
                    
                    // Validate file size (max 5MB)
                    const maxSize = 5 * 1024 * 1024;
                    if (file.size > maxSize) {
                        alert('File size must be less than 5MB');
                        this.value = '';
                        return;
                    }
                    
                    // Show preview
                    document.getElementById('receiptUploadArea').style.display = 'none';
                    document.getElementById('receiptPreview').style.display = 'block';
                    document.getElementById('receiptFileName').textContent = file.name;
                }
            });
            
            // Check for pending notifications
            updateNotificationBadge();
            
            console.log('=== User Dashboard Initialized ===');
        });

        // Menu switching
        // Menu Sections - Define which sections exist and which show "Coming Soon"
        const menuSections = {
            'dashboard': { 
                hasSection: true, 
                sectionId: 'dashboard-section',
                label: 'Dashboard'
            },
            'payments': { 
                hasSection: true,
                isModal: true,
                modalId: 'paymentModal',
                label: 'Make Payment'
            },
            'history': { 
                hasSection: true,
                sectionId: 'contributions-section',
                label: 'My Contributions'
            },
            'reports': { 
                hasSection: true,
                sectionId: 'reports-section',
                label: 'My Reports'
            },
            'notifications': { 
                hasSection: false, 
                comingSoon: true,
                label: 'Notifications'
            },
            'events': { 
                hasSection: true,
                sectionId: 'events-section',
                label: 'Upcoming Events'
            },
            'profile': { 
                hasSection: false, 
                comingSoon: true,
                label: 'My Profile'
            }
        };

        function switchMenu(menu) {
            console.log(`Switching to menu: ${menu}`);
            
            // Update active menu item
            document.querySelectorAll('.menu-item').forEach(item => {
                item.classList.remove('active');
            });
            event.currentTarget.classList.add('active');
            
            // Get menu configuration
            const menuConfig = menuSections[menu];
            
            if (!menuConfig) {
                console.warn(`Unknown menu: ${menu}`);
                return;
            }
            
            // If it's a modal, open it
            if (menuConfig.isModal && menuConfig.modalId) {
                const modal = document.getElementById(menuConfig.modalId);
                if (modal) {
                    modal.classList.add('active');
                    console.log(`Opened modal: ${menuConfig.modalId}`);
                } else {
                    console.warn(`Modal not found: ${menuConfig.modalId}`);
                }
            }
            // If section exists, scroll to it
            else if (menuConfig.hasSection && menuConfig.sectionId) {
                const section = document.getElementById(menuConfig.sectionId);
                if (section) {
                    section.scrollIntoView({ behavior: 'smooth', block: 'start' });
                    console.log(`Scrolled to section: ${menuConfig.sectionId}`);
                } else {
                    console.warn(`Section not found: ${menuConfig.sectionId}`);
                }
            } 
            // If coming soon, show alert
            else if (menuConfig.comingSoon) {
                const menuLabel = menuConfig.label || menu.charAt(0).toUpperCase() + menu.slice(1);
                alert(`🚀 ${menuLabel} feature is coming soon!`);
                console.log(`Coming soon: ${menu}`);
            }
        }

        // Payment modal functions
        function openPaymentModal() {
            document.getElementById('paymentModal').classList.add('active');
        }

        function closePaymentModal() {
            document.getElementById('paymentModal').classList.remove('active');
        }

        function submitPaymentRequest() {
            const amount = document.getElementById('paymentAmount').value;
            const method = document.getElementById('paymentMethod').value;
            const receipt = document.getElementById('paymentReceipt').files[0];
            const groupId = window.currentGroupId;
            
            // Check if group ID is available
            if (!groupId) {
                alert('Error: Unable to determine your group. Please reload the page and try again.');
                console.error('currentGroupId not set');
                return;
            }
            
            // Validation
            if (!amount) {
                alert(getTranslation('amountRequired', 'Please enter amount'));
                return;
            }
            
            if (amount < 50000) {
                alert(getTranslation('minAmountError', 'Minimum amount is 50,000 RWF'));
                return;
            }
            
            if (!method) {
                alert(getTranslation('methodRequired', 'Please select payment method'));
                return;
            }
            
            if (!receipt) {
                alert(getTranslation('receiptRequired', 'Please upload a payment receipt'));
                return;
            }
            
            // Validate file type
            const validTypes = ['image/jpeg', 'image/png', 'application/pdf'];
            if (!validTypes.includes(receipt.type)) {
                alert(getTranslation('invalidFileType', 'Please upload a PDF or image file (JPG, PNG)'));
                return;
            }
            
            // Validate file size (max 5MB)
            const maxSize = 5 * 1024 * 1024; // 5MB
            if (receipt.size > maxSize) {
                alert(getTranslation('fileTooLarge', 'File size must be less than 5MB'));
                return;
            }
            
            // Show loading
            const payBtn = document.querySelector('#paymentModal .btn-primary');
            const originalText = payBtn.textContent;
            payBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> ' + getTranslation('sending', 'Sending...');
            payBtn.disabled = true;
            
            // Read receipt file as base64
            const reader = new FileReader();
            reader.onload = function(e) {
                const receiptBase64 = e.target.result;
                
                // Prepare JSON payload
                const payload = {
                    amount: parseFloat(amount),
                    method: method,
                    groupId: groupId,
                    receiptUrl: receiptBase64,
                    receiptFileName: receipt.name,
                    receiptMimeType: receipt.type,
                    receiptSize: receipt.size
                };
                
                // Add mobile/bank details if provided
                const mobileNumber = document.getElementById('mobileNumber')?.value;
                const bankDetails = document.getElementById('bankDetails')?.value;
                if (mobileNumber) payload.mobileNumber = mobileNumber;
                if (bankDetails) payload.bankDetails = bankDetails;
                
                // Send payment request to backend
                fetch('http://localhost:5000/api/payments/request', {
                    method: 'POST',
                    headers: {
                        'Authorization': 'Bearer ' + localStorage.getItem('authToken'),
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(payload)
                })
                .then(response => {
                    console.log('Response status:', response.status);
                    console.log('Response:', response);
                    
                    if (response.status === 404) {
                        throw new Error('Payment endpoint not yet implemented on backend. Please contact your administrator. (404 Not Found)');
                    }
                    if (response.status === 401) {
                        throw new Error('Unauthorized. Your session may have expired. Please log in again.');
                    }
                    if (response.status === 403) {
                        throw new Error('Forbidden. You do not have permission to submit payment requests.');
                    }
                    if (!response.ok) {
                        return response.json().then(err => {
                            throw new Error(err.error || err.message || `Server error: ${response.status}`);
                        });
                    }
                    return response.json();
                })
                .then(data => {
                    console.log('Payment request submitted:', data);
                    
                    // Reset button
                    payBtn.innerHTML = originalText;
                    payBtn.disabled = false;
                    
                    // Close modal and clear form
                    closePaymentModal();
                    clearPaymentForm();
                    
                    // Show success message
                    alert(getTranslation('paymentRequestSent', 'Payment request sent to leader for approval. We will notify you once it is verified.'));
                    
                    // Reload page to show updated data
                    setTimeout(() => {
                        location.reload();
                    }, 500);
                })
                .catch(error => {
                    console.error('Error submitting payment request:', error);
                    
                    // Reset button
                    payBtn.innerHTML = originalText;
                    payBtn.disabled = false;
                    
                    // Provide more detailed error message
                    let errorMessage = error.message;
                    if (error.message.includes('Failed to fetch')) {
                        errorMessage = 'Unable to connect to server. Please check your internet connection and try again.';
                    }
                    
                    alert(getTranslation('errorSubmittingPayment', 'Error: ' + errorMessage));
                });
            };
            
            // Start reading the file
            reader.readAsDataURL(receipt);
        }

        function clearReceiptUpload() {
            // Clear file input
            document.getElementById('paymentReceipt').value = '';
            
            // Hide preview and show upload area
            document.getElementById('receiptPreview').style.display = 'none';
            document.getElementById('receiptUploadArea').style.display = 'block';
        }

        function clearPaymentForm() {
            // Reset all form fields
            const amountField = document.getElementById('paymentAmount');
            const methodField = document.getElementById('paymentMethod');
            const mobileField = document.getElementById('mobileNumber');
            const bankField = document.getElementById('bankDetails');
            
            if (amountField) amountField.value = '50000';
            if (methodField) methodField.value = '';
            if (mobileField) mobileField.value = '';
            if (bankField) bankField.value = '';
            
            // Clear receipt
            clearReceiptUpload();
        }

        function updateDashboardAfterPayment() {
            // Update today's contribution status
            const todayStat = document.querySelector('.stat-card .stat-value');
            todayStat.textContent = '50,000 RWF';
            
            const todayStatus = document.querySelector('.stat-card .stat-change');
            todayStatus.innerHTML = '<i class="fas fa-check"></i> ' + getTranslation('paidToday', 'Paid today');
            todayStatus.className = 'stat-change positive';
            
            // Update recent contributions table
            const tableRow = document.querySelector('.contributions-table tbody tr:nth-child(5)');
            tableRow.innerHTML = `
                <td>${new Date().toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' })}</td>
                <td>50,000 RWF</td>
                <td>${getTranslation('mobileMoney', 'Mobile Money')}</td>
                <td><span class="contribution-status status-paid">${getTranslation('paid', 'Paid')}</span></td>
                <td><button class="btn btn-sm btn-secondary" onclick="downloadReceipt('today')"><i class="fas fa-download"></i></button></td>
            `;
        }

        // Download functions
        function downloadReceipt(receiptId) {
            alert(getTranslation('downloadReceipt', 'Downloading receipt #' + receiptId + '...'));
            // In real app, this would download a PDF
        }

        function downloadReport(reportId) {
            alert(getTranslation('downloadReport', 'Downloading ' + reportId + ' report...'));
            // In real app, this would download a PDF
        }

        function downloadMyReport(type) {
            const reportName = type === 'monthly' ? getTranslation('monthlyReport', 'Monthly Report') : getTranslation('yearlyReport', 'Yearly Report');
            alert(getTranslation('downloading', 'Downloading your ') + reportName + '...');
        }

        // View functions
        function viewAllMyContributions() {
            alert(getTranslation('viewAllContributions', 'Opening all your contributions...'));
        }

        function viewAllEvents() {
            alert(getTranslation('viewCalendar', 'Opening calendar view...'));
        }

        function contactAdmin() {
            alert(getTranslation('contactAdmin', 'Opening contact form for administrator...'));
        }

        function viewMyContributions() {
            alert(getTranslation('viewHistory', 'Opening your contribution history...'));
        }

        // Notification functions
        function updateNotificationBadge() {
            // In real app, this would fetch from API
            const count = 3;
            document.getElementById('notificationCount').textContent = count;
        }

        // Logout function
        function logout() {
            if (confirm(getTranslation('confirmLogout', 'Are you sure you want to logout?'))) {
                // In real app, this would clear session and redirect
                localStorage.removeItem('userToken');
                window.location.href = 'login.html';
            }
        }

        // Helper function for translations
        function getTranslation(key, defaultText) {
            const translations = {
                'menuSwitch': {
                    'en': 'Switching to ',
                    'rw': 'Kwinjira muri ',
                    'fr': 'Passage à '
                },
                'minAmountError': {
                    'en': 'Minimum amount is 50,000 RWF',
                    'rw': 'Amafaranga make ni 50,000 RWF',
                    'fr': 'Le montant minimum est de 50,000 RWF'
                },
                'processing': {
                    'en': 'Processing...',
                    'rw': 'Biri gukorwa...',
                    'fr': 'Traitement...'
                },
                'paymentSuccess': {
                    'en': 'Payment of ',
                    'rw': 'Amafaranga ',
                    'fr': 'Paiement de '
                },
                'paidToday': {
                    'en': 'Paid today',
                    'rw': 'Yishyuye uyu munsi',
                    'fr': 'Payé aujourd\'hui'
                },
                'downloadReceipt': {
                    'en': 'Downloading receipt #',
                    'rw': 'Kuramo resi #',
                    'fr': 'Téléchargement du reçu #'
                },
                'downloadReport': {
                    'en': 'Downloading ',
                    'rw': 'Kuramo ',
                    'fr': 'Téléchargement '
                },
                'monthlyReport': {
                    'en': 'Monthly Report',
                    'rw': 'Raporo y\'Ukwezi',
                    'fr': 'Rapport Mensuel'
                },
                'yearlyReport': {
                    'en': 'Yearly Report',
                    'rw': 'Raporo y\'Umwaka',
                    'fr': 'Rapport Annuel'
                },
                'downloading': {
                    'en': 'Downloading your ',
                    'rw': 'Kuramo ',
                    'fr': 'Téléchargement de votre '
                },
                'viewAllContributions': {
                    'en': 'Opening all your contributions...',
                    'rw': 'Gufungura uruhare rwawe rwose...',
                    'fr': 'Ouverture de toutes vos contributions...'
                },
                'viewCalendar': {
                    'en': 'Opening calendar view...',
                    'rw': 'Gufungura kalendari...',
                    'fr': 'Ouverture du calendrier...'
                },
                'contactAdmin': {
                    'en': 'Opening contact form for administrator...',
                    'rw': 'Gufungura ifishi yo kuvugana n\'umuyobozi...',
                    'fr': 'Ouverture du formulaire de contact pour l\'administrateur...'
                },
                'viewHistory': {
                    'en': 'Opening your contribution history...',
                    'rw': 'Gufungura amateka y\'uruhare rwawe...',
                    'fr': 'Ouverture de votre historique de contributions...'
                },
                'confirmLogout': {
                    'en': 'Are you sure you want to logout?',
                    'rw': 'Urakomeye ko ushaka gusohoka?',
                    'fr': 'Êtes-vous sûr de vouloir vous déconnecter?'
                },
                'paid': {
                    'en': 'Paid',
                    'rw': 'Yishyuye',
                    'fr': 'Payé'
                },
                'mobileMoney': {
                    'en': 'Mobile Money',
                    'rw': 'Amafaranga ya Telefone',
                    'fr': 'Mobile Money'
                }
            };
            
            const parts = defaultText.split(' ');
            const baseKey = key;
            const dynamicPart = parts.length > 2 ? parts.slice(2).join(' ') : '';
            
            return translations[key]?.[currentLanguage] || defaultText;
        }
    </script>
</body>
</html>